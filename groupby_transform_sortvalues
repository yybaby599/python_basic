# transform()和agg()区别
transform会返回和原始表格一样长度的表，agg就只剩两行
df.groupby('department')['salary'].max()
df.groupby('department').agg({'salary':'max', 'age': 'max'})
df.groupby('department')['salary'].transform('max')
这时候写df['max']= df.groupby('department')['salary'].transform('max')
groupby不作为index ：, df.groupby('department'，as_index=False)

sort values基本上也是只能保留第一个
merge = merge.sort_values(['Department','salary'],ascending = [True,False]).drop_duplicates(subset ='Department',keep = 'first')

merge= merge[merge['salary'] ==merge['Salary']]
merge =merge[['Department','Employee','Salary']]
学吧 学无止境

drop_duplicates()
只关心某些列时，可以用 subset; df.drop_duplicates(subset=["A"])
df.drop_duplicates(subset=["A"], keep="last")
keep="first"（默认） → 保留第一次出现的
keep="last" → 保留最后一次出现的
keep=False → 全部重复都删掉
